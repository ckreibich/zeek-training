If you are familiar with tables & sets may be you should attempt these questions:

1) For each remote IP, how many uniq ports do you see ?
2) For each remote IP, how many uniq dst IPs do you see ?
3) For each remote IP, how many uniq ports do you see on each uniq destination ip ?
4) Extend expire_function to get counts every hour ?
5) Experiment with create_expire, read_expire and write_expire

Extra-credits:
5) Can you calculate how many bytes each dst port received ?
6) How many bytes each source IP has sent/received ?

Extra-extra credits:
7) Can do you some math foo to find avg bytes per host and then find anomalous events - ex. Possibly used is ssh brute forcer successful login attempt determination
8) You can probably do this with duration of connections too ?


To rephrase:

Task 1) I would like to track how many connections does an IP address make ?
Task 2) How many times have two hosts talked with each other in last hour ?
Task 3) Can we build a list of all services on all hosts on the network ?
